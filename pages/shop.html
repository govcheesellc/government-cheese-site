<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop | Government Cheese</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header class="main-header">
        <nav class="nav-container">
            <div class="logo">GOVERNMENT CHEESE</div>
            <ul class="nav-links">
                <li><a href="../index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="shop.html">Shop</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main class="shop-section">
        <h1 class="section-title">SHOP</h1>
        <div class="products-grid">
            <!-- Product Card Template -->
            <div class="product-card">
                <div class="product-image">
                    <img src="../assets/images/tshirt-1.jpg" alt="Classic Tee">
                    <div class="hover-effect"></div>
                </div>
                <div class="product-info">
                    <h3>Classic Tee</h3>
                    <p class="price">$29.99</p>
                    <button class="snipcart-add-item product-button"
                        data-item-id="classic-tee"
                        data-item-price="29.99"
                        data-item-url="/pages/shop"
                        data-item-description="Classic Government Cheese T-Shirt"
                        data-item-image="../assets/images/tshirt-1.jpg"
                        data-item-name="Classic Tee">
                        Pre-order Now
                    </button>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2024 Government Cheese. All rights reserved.</p>
    </footer>

    <!-- Snipcart script with API key and retry logic -->
    <script>
        window.SnipcartSettings = {
            publicApiKey: 'ST_ZDJjMjY5ODctZjMyZC00N2VhLTkzNDItNjg0ZGFmYTY1YmY3NjM4NjY0MTQ3NTc5NTEyNjM1',
            loadStrategy: 'on-user-interaction',
        };

        // Retry logic for loading Snipcart
        function loadSnipcartWithRetry(retries = 3, delay = 2000) {
            let attempts = 0;
            const loadSnipcartScript = () => {
                try {
                    if (window.LoadSnipcart) {
                        window.LoadSnipcart();
                    } else {
                        throw new Error("Snipcart script not yet available.");
                    }
                } catch (error) {
                    console.error("Error loading Snipcart:", error);
                    attempts++;
                    if (attempts < retries) {
                        console.log(`Retrying Snipcart load... (${attempts})`);
                        setTimeout(loadSnipcartScript, delay);
                    } else {
                        alert("Unable to load cart. Please try again later.");
                    }
                }
            };
            loadSnipcartScript();
        }

        document.addEventListener("DOMContentLoaded", () => {
            if (window.SnipcartSettings.loadStrategy === 'on-user-interaction') {
                ["click", "mouseover"].forEach(event =>
                    document.addEventListener(event, loadSnipcartWithRetry, { once: true })
                );
            } else {
                loadSnipcartWithRetry();
            }
        });
    </script>
</body>
</html>
